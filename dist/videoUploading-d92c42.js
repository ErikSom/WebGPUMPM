!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="dist/",n(n.s=20)}({2:function(e,t,n){"use strict";var r=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))};let o=void 0;t.a=function(){return r(this,void 0,void 0,(function*(){if(void 0!==o)return o;const e=yield import("https://unpkg.com/@webgpu/glslang@0.0.15/dist/web-devel/glslang.js");return o=yield e.default(),o}))}},20:function(e,t,n){"use strict";n.r(t),n.d(t,"title",(function(){return i})),n.d(t,"description",(function(){return a})),n.d(t,"init",(function(){return u})),n.d(t,"glslShaders",(function(){return c})),n.d(t,"wgslShaders",(function(){return l}));var r=n(2),o=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))};const i="Video Texture",a="This example shows how to upload video frame to WebGPU.";function u(e){return o(this,void 0,void 0,(function*(){const t=document.createElement("video");t.loop=!0,t.autoplay=!0,t.muted=!0,t.src="assets/video/pano.webm",yield t.play();const n=yield navigator.gpu.requestAdapter(),o=yield n.requestDevice(),i=yield Object(r.a)(),a=e.getContext("gpupresent"),u=new Float32Array([1,1,0,1,0,1,-1,0,1,1,-1,-1,0,0,1,1,1,0,1,0,-1,-1,0,0,1,-1,1,0,0,0]),l=o.createBuffer({size:u.byteLength,usage:GPUBufferUsage.VERTEX,mappedAtCreation:!0});new Float32Array(l.getMappedRange()).set(u),l.unmap();const f=a.configureSwapChain({device:o,format:"bgra8unorm"}),s=o.createRenderPipeline({vertexStage:{module:o.createShaderModule({code:c.vertex,transform:e=>i.compileGLSL(e,"vertex")}),entryPoint:"main"},fragmentStage:{module:o.createShaderModule({code:c.fragment,transform:e=>i.compileGLSL(e,"fragment")}),entryPoint:"main"},primitiveTopology:"triangle-list",vertexState:{vertexBuffers:[{arrayStride:20,attributes:[{shaderLocation:0,offset:0,format:"float3"},{shaderLocation:1,offset:12,format:"float2"}]}]},colorStates:[{format:"bgra8unorm"}]}),d=o.createSampler({magFilter:"linear",minFilter:"linear"}),m=o.createTexture({size:{width:t.videoWidth,height:t.videoHeight,depth:1},format:"rgba8unorm",usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.SAMPLED}),v=o.createBindGroup({layout:s.getBindGroupLayout(0),entries:[{binding:0,resource:d},{binding:1,resource:m.createView()}]});return function(){createImageBitmap(t).then(e=>{o.defaultQueue.copyImageBitmapToTexture({imageBitmap:e,origin:{x:0,y:0}},{texture:m},{width:t.videoWidth,height:t.videoHeight,depth:1});const n=o.createCommandEncoder(),r={colorAttachments:[{attachment:f.getCurrentTexture().createView(),loadValue:{r:0,g:0,b:0,a:1}}]},i=n.beginRenderPass(r);i.setPipeline(s),i.setVertexBuffer(0,l),i.setBindGroup(0,v),i.draw(6,1,0,0),i.endPass(),o.defaultQueue.submit([n.finish()])})}}))}const c={vertex:"#version 450\nlayout(location = 0) in vec3 position;\nlayout(location = 1) in vec2 uv;\n\nlayout(location = 0) out vec2 fragUV;\n\nvoid main() {\n  gl_Position = vec4(position, 1.0);\n  fragUV = uv;\n}\n",fragment:"#version 450\nlayout(set = 0, binding = 0) uniform sampler mySampler;\nlayout(set = 0, binding = 1) uniform texture2D myTexture;\n\nlayout(location = 0) in vec2 fragUV;\nlayout(location = 0) out vec4 outColor;\n\nvoid main() {\n  outColor = texture(sampler2D(myTexture, mySampler), fragUV);\n}\n"},l={vertex:"#version 450\n[[location(0)]] var<in> position : vec3<f32>;\n[[location(1)]] var<in> uv : vec2<f32>;\n\n[[location(0)]] var<out> fragUV : vec2<f32>;\n[[builtin(position)]] var<out> Position : vec4<f32>;\n\nvoid main() {\n  Position = vec4(position, 1.0);\n  fragUV = uv;\n}\n",fragment:"\n[[binding(0), set(0)]] var<uniform_constant> mySampler: sampler;\n[[binding(1), set(0)]] var<uniform_constant> myTexture: texture_sampled_2d<f32>;\n\n[[location(0)]] var<in> fragUV : vec2<f32>;\n[[location(0)]] var<out> outColor : vec4<f32>;\n\n[[stage(fragment)]]\nfn main() -> void {\n  outColor =  textureSample(myTexture, mySampler, fragUV);\n  return;\n}\n"}}});
//# sourceMappingURL=videoUploading-d92c42.js.map